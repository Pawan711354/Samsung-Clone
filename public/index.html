<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>My Samsung Clone</title>
    <link rel="stylesheet" href="styles.css" />
</head>
<body>

    <!-- Header & Hero section -->
    <header class="hero">
        <video autoplay muted loop playsinline class="hero-video">
  <source src="videos/Video 09.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>

        <nav>
           <!-- ‚¨ÜÔ∏è TOP BAR OVER VIDEO -->
  <div class="hero-top-nav">
    <nav>
      <h1>
        <img src="images/Samsung_Orig_Wordmark_WHITE_RGB.png" alt="Samsung" class="logo" />
      </h1>

            <div class="dropdown mobile-dropdown">
                <a href="mobiles-tablets.html" class="nav-link"> Mobile / Tablet </a>
            </div>

            <div class="dropdown tv-dropdown">
                <a href="laptop-display.html" class="nav-link"> Laptop / Display</a> 
            </div>

            <div class="dropdown computers-dropdown">
                <a href="home-appliances.html" class="nav-link">Home Appliances </a>
            </div>

            <div class="dropdown appliances-dropdown">
                <a href="watches.html" class="nav-link">Watches & Other Products </a>
            </div>

            <!-- About Us with popup -->
            <div class="about-icon">
                <a href="#">Shops</a>
                <div class="about-popup" id="aboutPopup">
                    <a href="#">USA </a>
                    <a href="#">China</a>
                    <a href="#">North Korea</a>
                    <a href="#">South Korea</a>
                    <a href="#">Sri Lanka</a>
                    <a href="#">New Zealand</a>
                    <a href="#">India</a>
                    <a href="#">Japan</a>
                </div>
            </div>
            <a href="#">AI</a>

           <div class="nav-right">
   <div id="searchContainer" style="position: relative;">
      <input
        type="text"
        id="searchInput"
        placeholder="Search products..."
        oninput="handleLiveSearch()"
        style="padding: 0.5rem 1rem; border: 1px solid #ccc; border-radius: 20px; font-size: 1rem; width: 250px;"
      />
      <div id="suggestions"
           style="position: absolute; background: #ffffff; width: 100%; top: 100%; left: 0; border: 1px solid #ffffff; border-radius: 10px; display: none; z-index: 999;color: #000000;">
      </div>
    </div>
  <!-- Cart icon -->
  <a href="javascript:void(0)" class="cart-icon cart-icon-counter" onclick="toggleCart()">üõí<span id="cartCount">0</span></a>
  <!-- Login / Dashboard Icon -->
  <a href="login.html" class="icon-btn" id="accountIcon" title="Account">üë§</a>
  <!-- Logout button -->
  <a href="#" class="icon-btn" id="logoutBtn" style="display: none;" title="Logout">üö™</a>
</div>
    </nav>
  </div>


        </nav>

        <h2>Discover the latest Galaxy Devices</h2>
        <a href="shop-now.html" class="cta-button">Shop Now</a>

       <div class="cart-popup" id="cartPopup">
  <h3>Your Cart</h3>
  <div id="cartItems"></div>
  <div class="cart-summary">
    Total Items: <span id="itemCount">0</span><br>
    Grand Total: <span id="grandTotal">$0</span><br><br>
    <button id="checkoutBtn" style="padding: 8px 16px; background-color: #0074e4; color: white; border: none; border-radius: 4px; cursor: pointer;">Go to Checkout</button>
  </div>
</div>
    </header>

    <!-- Featured Product Section -->
    <section id="featured" class="featured-product">
        <div class="button-container">
            <a href="mobiles-tablets.html" class="learn-more-btn">Learn more</a>
        </div>
    </section>

    <!-- Categories -->
    <section class="categories" id="categories">
        <div class="category-list">
            <div class="category">
                <img src="images/MDMX_Feature_Card1_560X560.jpg" alt="Galaxy S25 Ultra" />
                <p>Galaxy S25 Ultra</p>
                <a href="Galaxy-S25-Ultra.html" class="buy-btn">Buy Now</a>
            </div>
            <div class="category">
                <img src="images/MDMX_Feature_Card3_560X560.jpg" alt="Galaxy Tab S10 Ultra" />
                <p>Galaxy Tab S10 Ultra</p>
                <a href="Galaxy-Tab-S10-Ultra.html" class="buy-btn">Buy Now</a>
            </div>
            <div class="category">
                <img src="images/MDMX_Feature_Card2_560X560.jpg" alt="Galaxy S25 Edge" />
                <p>Galaxy S25 Edge</p>
                <a href="Galaxy-S25-Edge.html" class="buy-btn">Buy Now</a>
            </div>
            <div class="category">
                <img src="images/Galaxy Watch.JPG" alt="Galaxy Watch Ultra" />
                <p>Galaxy Watch Ultra</p>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
        </div>
    </section>

    <!-- Special Promotions -->
    <section class="special-promotions">
        <div class="promo-content">
            <h2>New AI Smart Monitors</h2>
            <p>Watch, Play, Work in Style with Samsung Vision AI</p>
        </div>
        <div class="promo-buttons">
            <a href="laptop-display.html" class="promo-btn">Learn More</a>
            <a href="#" class="promo-btn">Pre Order Now</a>
        </div>
    </section>

    <!-- Our Products -->
    <section class="our-products" id="our-products">
        <div class="product-list">
            <div class="product">
                <img src="images/LS32BG752NNXGO_V2.jpg" alt="Neo QLED 8K" />
                <p>Neo QLED 8K</p>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
            <div class="product">
                <img src="images/LS49CG954SNXZA_V2(1).jpg" alt="Neo KLED 8K" />
                <p>Neo KLED 8K</p>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
            <div class="product">
                <img src="images/MDVD_Feature_Card4_560X560.jpg" alt="Odyssey OLED G8" />
                <p>Odyssey OLED G8</p>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
            <div class="product">
                <img src="images/MDVD_Feature_Card2_560X560.jpg" alt="The Frame Pro" />
                <p>The Frame Pro</p>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
        </div>
    </section>

    <!-- Support Section -->
    <section class="support-section" id="support">

        <div class="support-buttons">
            <a href="home-appliances.html" class="support-btn">Learn More</a>
            <a href="#" class="support-btn">Buy Now</a>
        </div>
    </section>

    <!-- About Us section -->
    <section class="about-us" id="about-us">
        <div class="about-list">
            <div class="about-item">
                <img src="images/DVE50BG8300V_01_Brushed_Black_SCOM.jpg" alt="Bespoke AI Laundry" />
                <p>Bespoke AI Laundry</p>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
            <div class="about-item">
                <img src="images/RF90F29AECR_01_Charcoal_Glass_Stainless_Steel_SCOM.webp" alt="Bespoke AI Refrigerator" />
                <p>Bespoke AI Refrigerator</p>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
            <div class="about-item">
                <img src="images/NSI6DG9900SR_01_Stainless-Steel_SCOM.webp" alt="Bespoke Range" />
                <p>Bespoke Range</p>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
            <div class="about-item">
                <img src="images/DW90F89P0USR_01_Stainless_Steel_SCOM.webp" alt="Bespoke Dishwasher" />
                <p>Bespoke Dishwasher</p>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
        </div>
    </section>

    <!-- Latest Highlights -->
    <section class="latest-highlights" id="latest-highlights">
        <h3>Latest Highlights</h3>
        <div class="highlights-list">
            <!-- Repeat highlight-item as needed -->
            <div class="highlight-item">
                <img src="images/DW90F89P0USR_01_Stainless_Steel_SCOM.webp" alt="Highlight 1" />
                <p>38 dBA Bespoke Auto Open Door Dishwasher with 3rd Rack</p>
                <span class="price">$999.99</span>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
            <div class="highlight-item">
                <img src="images/RF90F29AECR_01_Charcoal_Glass_Stainless_Steel_SCOM.webp" alt="Highlight 2" />
                <p>Bespoke 29 cu. ft. 4-Door French Door Refrigerator with AI Family Hub‚Ñ¢+ & AI Vision Inside‚Ñ¢ in Charcoal Glass and Stainless Steel</p>
                <span class="price">$1099.99</span>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
            <div class="highlight-item">
                <img src="images/RF27CG5100SR_01_Stainless_Steel_SCOM.webp" alt="Highlight 3" />
                <p>27 cu. ft. Mega Capacity Counter Depth 3-Door French Door Refrigerator with Dual Auto Ice Maker in Stainless Steel</p>
                <span class="price">$1199.99</span>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
            <div class="highlight-item">
                <img src="images/NQ70CB700D12_01_White_Glass_SCOM.webp" alt="Highlight 4" />
                <p>Bespoke 30" Microwave Combination Wall Oven with Flex Duo‚Ñ¢ in White Glass</p>
                <span class="price">$1299.99</span>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
            <div class="highlight-item">
                <img src="images/NV51CB700S12_01_White_Glass_SCOM.webp" alt="Highlight 5" />
                <p>Bespoke 30" White Glass Single Wall Oven with AI Pro Cooking‚Ñ¢ Camera</p>
                <span class="price">$1399.99</span>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
            <div class="highlight-item">
                <img src="images/NZ30K7880US.webp" alt="Highlight 6" />
                <p>30" Smart Induction Cooktop in Stainless Steel</p>
                <span class="price">$1499.99</span>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
            <div class="highlight-item">
                <img src="images/NZ30K7570RS.webp" alt="Highlight 7" />
                <p>30" Smart Electric Cooktop with Sync Elements in Stainless Steel</p>
                <span class="price">$1599.99</span>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
            <div class="highlight-item">
                <img src="images/us-q-series-soundbar-hw-q800f-hw-q800f-za-546923668.webp" alt="Highlight 8" />
                <p>Q-series Soundbar HW-Q800F 5.1.2 ch Subwoofer (2025)</p>
                <span class="price">$1699.99</span>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
            <div class="highlight-item">
                <img src="images/QE1D_HW-Q600C_angle_bundle_1600x1200_v2.webp" alt="Highlight 9" />
                <p>85" QLED 4K TV with 3.1.2 ch. DOLBY ATMOS Soundbar</p>
                <span class="price">$1799.99</span>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
            <div class="highlight-item">
                <img src="images/us-smart-m9-32m90sf-ls32fm902snxza-547845238.webp" alt="Highlight 10" />
                <p>32" Smart Monitor M9 M90SF 4K OLED Samsung Vision AI</p>
                <span class="price">$1899.99</span>
                <a href="#" class="buy-btn">Buy Now</a>
            </div>
        </div>
    </section>

 <!-- Chatbot Floating Button -->
<button id="chatbotBtn" onclick="toggleChat()" style="
  position: fixed;
  bottom: 30px;
  right: 30px;
  width: 64px;
  height: 64px;
  border-radius: 50%;
  overflow: hidden;
  border: none;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  cursor: pointer;
  z-index: 10000;
  padding: 0;
  background: transparent;
">
  <!-- Video background inside the button -->
  <video autoplay muted loop playsinline style="
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%;
    z-index: 1;
  ">
    <source src="videos/Chatbot.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>

</button>


<!-- Chat Popup -->
<div id="chatPopup" style="
  position: fixed;
  bottom: 110px;
  right: 30px;
  width: 360px;
  height: 500px;
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
  display: none;
  z-index: 9999;
  overflow: hidden;
  display: none;
  flex-direction: column;
">

  <!-- Header -->
  <div id="chatbot-header" style="
    background-color: #1428a0;
    color: white;
    padding: 14px 20px;
    font-size: 16px;
    font-weight: bold;
    border-top-left-radius: 16px;
    border-top-right-radius: 16px;
    cursor: pointer;
  ">
    ü§ñ Samsung Assistant
  </div>

  <!-- Chat Messages -->
  <div id="chatbot-messages" style="
    flex-grow: 1;
    padding: 12px;
    overflow-y: auto;
    background-color: #f5f5f5;
    display: flex;
    flex-direction: column;
    gap: 10px;
  "></div>

  <!-- Chat Input -->
  <form id="chatbot-form" style="
    display: flex;
    padding: 10px;
    background: #fff;
    border-top: 1px solid #ccc;
    gap: 8px;
    align-items: center;
  ">
    <input id="chatbot-input" type="text" placeholder="Ask me anything..." style="
      flex-grow: 1;
      padding: 10px;
      border-radius: 20px;
      border: 1px solid #ccc;
      outline: none;
    " />
    <button type="submit" style="
      background: #1428a0;
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      border: none;
      cursor: pointer;
    ">Send</button>
  </form>
    

<button id="download-chat" style="
  background: none;
  border: none;
  color: #999;
  font-size: 13px;
  margin-top: 8px;
  cursor: pointer;
  display: block;
  margin-left: auto;
  margin-right: auto;
">
  üíæ Download Chat
</button>

  <button onclick="clearChat()" style="
  background: none;
  border: none;
  color: #4b4a4a;
  font-size: 13px;
  margin-top: 8px;
  cursor: pointer;
  display: block;
  margin-left: auto;
  margin-right: auto;
">
  üóëÔ∏è Clear Chat
</button>

  </form>

</div>
    
<!-- Information Section -->
    <section class="information-section">
        <div class="info-column">
            <h4>About Us</h4>
            <ul>
                <li><a href="#">Leadership & Mission</a></li>
                <li><a href="#">Our Business</a></li>
                <li><a href="#">Brand Identity</a></li>
                <li><a href="#">Careers </a></li>
                <li><a href="#">Investor Relations </a></li>
                <li><a href="#">Newsroom </a></li>
                <li><a href="#">Ethics </a></li>
                <li><a href="#">Samsung Designs </a></li>
            </ul>
        </div>
        <div class="info-column">
            <h4>Support</h4>
            <ul>
                <li><a href="#">Chat With Us</a></li>
                <li><a href="#">Order Help</a></li>
                <li><a href="#">Product Help</a></li>
                <li><a href="#">Your Account</a></li>
                <li><a href="#">Register Your Account </a></li>
                <li><a href="#">Request a Repair </a></li>
                <li><a href="#">Contact Us </a></li>
                <li><a href="#">Samsung Community </a></li>
                <li><a href="#">Feedbacks </a></li>
                <li><a href="#">Manual & Software </a></li>
                <li><a href="#">Slide-In Electronic Range Recall </a></li>
                <li><a href="#">Returns </a></li>
            </ul>
        </div>
        <div class="info-column">
            <h4>Offers</h4>
            <ul>
                <li><a href="#">Offers</a></li>
                <li><a href="#">Samsung Rewards</a></li>
                <li><a href="#">Education Offer Program</a></li>
                <li><a href="#">Government Offer Program</a></li>
                <li><a href="#">Military Offer Program </a></li>
                <li><a href="#">Employee Offer Program </a></li>
                <li><a href="#">First Responder Offer Program </a></li>
                <li><a href="#">Business Offer Program </a></li>
            </ul>
        </div>
        <div class="info-column">
            <h4>Sustainability</h4>
            <ul>
                <li><a href="#">Overview</a></li>
                <li><a href="#">Environment</a></li>
                <li><a href="#">Digital Responsibility</a></li>
                <li><a href="#">Security And Privacy</a></li>
                <li><a href="#">Accessibility </a></li>
                <li><a href="#">Labour & Human Rights </a></li>
                <li><a href="#">Conflict Minerals</a></li>
            </ul>
        </div>
        <div class="info-column">
            <h4>Locations</h4>
            <ul>
                <li><a href="#">Asia Pacific</a></li>
                <li><a href="#">Europe</a></li>
                <li><a href="#">Middle East & Africa</a></li>
                <li><a href="#">Latin America </a></li>
                <li><a href="#">North America </a></li>
            </ul>
        </div>
        <div class="info-column">
            <h4>Shop</h4>
            <ul>
                <li><a href="#">Samsung.com </a></li>
                <li><a href="#">Samsung Experience Store </a></li>
                <li><a href="#">Samsung Shop </a></li>
                <li><a href="#">Samsung Setup </a></li>
                <li><a href="#">Samsung TV Plus </a></li>
                <li><a href="#">Samsung Care+</a></li>
            </ul>
        </div>
    </section>

    <!-- Footer -->
    <footer>
  <img src="images/Samsung_Orig_Wordmark_WHITE_RGB.png" alt="Samsung Logo" class="footer-logo" />
  <p>&copy; 2025 Samsung Clone</p>
  <p>All Rights Reserved</p>
</footer>



    <script>
        const highlightsList = document.querySelector('.highlights-list');
    let scrollAmount = 0;
    let scrollStep = 1;
    let maxScroll = 0;

    function autoScroll() {
      scrollAmount += scrollStep;
      if (scrollAmount >= maxScroll) {
        scrollAmount = 0;
      }
      highlightsList.scrollLeft = scrollAmount;
      requestAnimationFrame(autoScroll);
    }

    window.addEventListener('load', () => {
      maxScroll = highlightsList.scrollWidth - highlightsList.clientWidth;
      autoScroll();

      const loggedInUser = localStorage.getItem('loggedInUser');
      const accountIcon = document.getElementById('accountIcon');
      const logoutBtn = document.getElementById('logoutBtn');

      if (loggedInUser) {
        accountIcon.href = 'dashboard.html';
        accountIcon.title = 'Go to Dashboard';
        logoutBtn.style.display = 'inline-block';
      } else {
        accountIcon.href = 'login.html';
        accountIcon.title = 'Log In';
        logoutBtn.style.display = 'none';
      }

      logoutBtn.addEventListener('click', (e) => {
        e.preventDefault();
        localStorage.removeItem('loggedInUser');
        window.location.reload();
      });
    });

    window.addEventListener('resize', () => {
      maxScroll = highlightsList.scrollWidth - highlightsList.clientWidth;
    });

    document.querySelectorAll('.dropdown').forEach((dropdown) => {
      dropdown.addEventListener('mouseenter', () =>
        dropdown.querySelector('div').classList.add('active')
      );
      dropdown.addEventListener('mouseleave', () =>
        dropdown.querySelector('div').classList.remove('active')
      );
    });

    const cartKey = "samsungCart";
    let cart = JSON.parse(localStorage.getItem(cartKey)) || [];

    function saveCart() {
      localStorage.setItem(cartKey, JSON.stringify(cart));
    }

    function removeFromCart(index) {
      cart.splice(index, 1);
      saveCart();
      updateCartUI();
    }

    function addToCart(title, price, img, color, storage, screenSize, processor) {
      cart.push({
        title,
        price: parseFloat(price.replace('$', '')),
        img,
        color,
        storage,
        screenSize,
        processor
      });
      saveCart();
      updateCartUI();
    }

    function toggleCart() {
      const cartPopup = document.getElementById('cartPopup');
      cartPopup.style.display = (cartPopup.style.display === 'block') ? 'none' : 'block';
    }

    function updateCartUI() {
      const cartItems = document.getElementById('cartItems');
      const itemCount = document.getElementById('itemCount');
      const grandTotal = document.getElementById('grandTotal');
      const cartCount = document.getElementById('cartCount');

      cartItems.innerHTML = '';
      let total = 0;

      cart.forEach((item, index) => {
        total += item.price;
        const div = document.createElement('div');
        div.className = 'cart-item';
        div.innerHTML = `
          <img src="${item.img}" alt="${item.title}" />
          <div class="cart-item-details">
            <strong>${item.title}</strong><br/>
            Color: ${item.color || "N/A"}<br/>
            Storage: ${item.storage || "N/A"}<br/>
            Screen Size: ${item.screenSize || 'N/A'}<br/>
            Processor: ${item.processor || 'N/A'}
          </div>
          <div class="cart-item-price">
            $${item.price.toFixed(2)}
          </div>
          <button onclick="removeFromCart(${index})" style="background:#ff4d4d; border:none; color:white; font-size:0.7rem; padding:2px 6px; border-radius:50%; cursor:pointer;">‚úñ</button>
        `;
        cartItems.appendChild(div);
      });

      itemCount.textContent = cart.length;
      grandTotal.textContent = `$${total.toFixed(2)}`;
      cartCount.textContent = cart.length;
    }

    document.addEventListener('DOMContentLoaded', () => {
      const checkoutBtn = document.getElementById('checkoutBtn');
      if (checkoutBtn) {
        checkoutBtn.addEventListener('click', () => {
          window.location.href = 'checkout.html';
        });
      }
      updateCartUI();
    });

    let products = [];

    fetch('products.json')
      .then(res => res.json())
      .then(data => {
        products = data;
      })
      .catch(error => {
        console.error("Failed to load product data:", error);
      });

    function handleLiveSearch() {
      const input = document.getElementById("searchInput").value.toLowerCase();
      const suggestions = document.getElementById("suggestions");
      suggestions.innerHTML = "";

      if (!input) {
        suggestions.style.display = "none";
        return;
      }

      const matches = products.filter(p =>
        p.name.toLowerCase().includes(input)
      );

      if (matches.length > 0) {
        matches.forEach(product => {
          const div = document.createElement("div");
          div.style.display = "flex";
          div.style.alignItems = "center";
          div.style.padding = "10px";
          div.style.cursor = "pointer";
          div.innerHTML = `
            <img src="${product.image}" style="width: 40px; height: 40px; border-radius: 5px; margin-right: 10px;" />
            <span>${product.name}</span>
          `;
          div.onclick = () => {
            window.location.href = product.url;
          };
          suggestions.appendChild(div);
        });
        suggestions.style.display = "block";
      } else {
        suggestions.innerHTML = "<div style='padding: 10px;'>No results found</div>";
        suggestions.style.display = "block";
      }
    }

   //  chatbot 
    // Toggle chatbot visibility on header click
  const chatbotBtn = document.getElementById('chatbotBtn');
  const chatbotMessages = document.getElementById('chatbot-messages');
  const chatbotForm = document.getElementById('chatbot-form');
  const chatbotInput = document.getElementById('chatbot-input');

  // Toggle chat visibility
  chatbotBtn.addEventListener('click', () => {
    const isVisible = chatbotMessages.style.display === 'block';
    chatbotMessages.style.display = isVisible ? 'none' : 'block';
    chatbotForm.style.display = isVisible ? 'none' : 'flex';
  });

  // Append message to chat window
  function appendMessage(text, sender = 'bot') {
    const msgDiv = document.createElement('div');
    msgDiv.textContent = text;
    msgDiv.style.padding = '10px 14px';
    msgDiv.style.borderRadius = '16px';
    msgDiv.style.maxWidth = '75%';
    msgDiv.style.wordWrap = 'break-word';
    msgDiv.style.fontSize = '14px';
    msgDiv.style.lineHeight = '1.4';
    msgDiv.style.marginBottom = '8px';
    msgDiv.style.display = 'inline-block';

    if (sender === 'user') {
      msgDiv.style.backgroundColor = '#1428a0';
      msgDiv.style.color = 'white';
      msgDiv.style.alignSelf = 'flex-end';
      msgDiv.style.borderBottomRightRadius = '0';
    } else {
      msgDiv.style.backgroundColor = '#eaeaea';
      msgDiv.style.color = '#333';
      msgDiv.style.alignSelf = 'flex-start';
      msgDiv.style.borderBottomLeftRadius = '0';
    }

    msgDiv.className = 'chat-message';
    msgDiv.setAttribute('data-sender', sender);

    chatbotMessages.appendChild(msgDiv);
    chatbotMessages.scrollTop = chatbotMessages.scrollHeight;

    saveMessages(); // Save chat every time a new message is added
  }

  function toggleChat() {
    const popup = document.getElementById('chatPopup');
    popup.style.display = popup.style.display === 'block' ? 'none' : 'block';
  }

  // Save chat to localStorage
  function saveMessages() {
    const allMessages = [];
    document.querySelectorAll('.chat-message').forEach(msg => {
      allMessages.push({
        text: msg.textContent,
        sender: msg.getAttribute('data-sender')
      });
    });
    localStorage.setItem('chat_history', JSON.stringify(allMessages));
  }

  // Load chat from localStorage
  function loadMessages() {
    const history = JSON.parse(localStorage.getItem('chat_history') || '[]');
    history.forEach(msg => appendMessage(msg.text, msg.sender));
  }

  // Clear chat button function
  function clearChat() {
    chatbotMessages.innerHTML = '';
    localStorage.removeItem('chat_history');
  }

  // Form submit handler
  chatbotForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const userMessage = chatbotInput.value.trim();
    if (!userMessage) return;

    appendMessage(userMessage, 'user');
    chatbotInput.value = '';

    try {
      const response = await fetch('/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message: userMessage })
      });

      if (!response.ok) throw new Error('Network response was not ok');

      const data = await response.json();
      if (Array.isArray(data)) {
        data.forEach(item => {
          if (item.text) appendMessage(item.text, 'bot');
        });
      } else {
        appendMessage('No response from bot.', 'bot');
      }
    } catch (error) {
      appendMessage('Sorry, there was an error connecting to the chatbot.', 'bot');
      console.error('Error:', error);
    }
  });

  // Start minimized and load messages
  chatbotMessages.style.display = 'none';
  chatbotForm.style.display = 'none';
  window.addEventListener('load', loadMessages);

  function downloadChat() {
  const history = JSON.parse(localStorage.getItem('chat_history') || '[]');
  if (history.length === 0) {
    alert('No chat history to download!');
    return;
  }

  let chatText = '';
  history.forEach(msg => {
    const sender = msg.sender === 'user' ? 'You' : 'Bot';
    chatText += `${sender}: ${msg.text}\n`;
  });

  const blob = new Blob([chatText], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);

  const a = document.createElement('a');
  a.href = url;
  a.download = 'chat_history.txt';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);

  URL.revokeObjectURL(url);
}

document.getElementById('download-chat').addEventListener('click', downloadChat);


</script>



</body>
</html>